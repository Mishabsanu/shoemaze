<style>
    .error {
        color: red;
    }
</style>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
    integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
<section>
    <div class="container">
        <div class="row">
            <div class="col-12 col-md-6 col-lg-6 text-center">
                <div class="rounded mt-5" style="width: 85%; -webkit-box-shadow: 0px 0px 10px 0px rgba(0,0,0,0.75);
-moz-box-shadow: 0px 0px 10px 0px rgba(239, 239, 239, 0.75);
box-shadow: 0px 0px 10px 0px rgba(0,0,0,0.75);">
                    <div class="d-flex">
                        <div class="">
                            <img src="/assets/product-images/{{users._id}}.jpg" {{!--
                                /assets/product-images/{{this._id}}.jpg --}}
                                style="height: 200px;width: 200px;border-radius: 100px;" alt="">
                        </div>
                        <div class="mx-5 mt-5">
                            <h2>Hello,<br>
                                {{person.Name}}</h2>
                        </div>
                    </div>
                    <div style="margin-top: 33px;">
                        <div>
                            <p href="" class="btn btn-primary  w-75" onclick="changeProfile()">Change profile</p>
                            <div class="changeProfile text-center border border-3 rounded w-75 ms-5"
                                style="display: none; margin: 58px;    width: 77%!important;">
                                <form action="/edit-profile/{{users._id}}" method="post" enctype="multipart/form-data"
                                    id="user-form">
                                    <input type="file" class=" text-center border" name="profileImg" placeholder="imgae"
                                        required>
                                    <input type="text" class="mt-3 text-center border" name="Name"
                                        value="{{users.Name}}" style="height: 40px;border-radius: 20px;"
                                        required><br><br>
                                    <input type="submit" value="Update" class="btn btn-primary">
                                </form><br>
                            </div><br>
                        </div>
                        <div>
                            <p href="" class="btn btn-primary w-75" onclick="showPass()">Change password</p>
                            <div class="password text-center border border-3 rounded w-75 ms-5"
                                style="display: none; margin: 58px;    width: 77%!important;">
                                <form action="/change-password" method="post" id="submit-form">
                                    {{#if passErr}}
                                    <p style="color: red;">{{passErr}}</p>
                                    {{/if}}
                                    <input type="password" name="old" class="mt-3 text-center border"
                                        style="height: 40px;border-radius: 20px;" placeholder="old password"
                                        required><br>
                                    <input type="password" name="new" class="mt-3 text-center border"
                                        style="height: 40px;border-radius: 20px;" placeholder="New password"
                                        required><br>
                                    <input type="password" name="confirm" class="mt-3 text-center border"
                                        style="height: 40px;border-radius: 20px;" placeholder="Confirm password"
                                        required><br><br>
                                    <input type="submit" class="btn btn-primary" value="submit">
                                </form><br>
                            </div>
                        </div>
                        <a class="btn btn-primary w-75 mb-3" href="/myorder">my orders</a>
                    </div>
                </div><br><br>
            </div>
            <div class="col-12 col-md-6 col-lg-6">
                <div class="rounded mt-5" style="width: 80%; -webkit-box-shadow: 0px 0px 10px 0px rgba(0,0,0,0.75);
-moz-box-shadow: 0px 0px 10px 0px rgba(0,0,0,0.75);
box-shadow: 0px 0px 10px 0px rgba(0,0,0,0.75);">
                    <div style="padding-top: 30px;">
                        <h5 class="ms-3" style="padding-left: 50px;">Personal Info:</h5>
                        <hr>
                        <p class="ms-4" style="padding-left: 50px;">Name: {{users.Name}}</p>
                        <p class="ms-4" style="padding-left: 50px;">Email: {{users.Email}}</p>
                        <p class="ms-4" style="padding-left: 50px;">Phone: {{users.phone}}</p>
                        <h4 class="ms-4" style="padding-left: 50px;">wallet Amount: {{person.wallet}}</h5><br>
                        <div style="padding-left: 80px;">
                             <a class="btn btn-primary w-75 mb-3" href="/walletHistory">wallet History</a>

                        </div>
                    </div>
                    <div>
                        <p href="" class="btn btn-primary ms-4 w-75" style="margin: 58px;    width: 77%!important;"
                            onclick="showAddress()">Add address</p>

                        <div class="address text-center border border-3"
                            style="display: none; margin: 58px;    width: 77%!important;">
                            <form action="/useraddress" method="post" id="submit-address" class="form">

                                <input type="text" id="ID" name="id" value="" hidden>
                                <input class="mt-3 text-center border" style="height: 40px;border-radius: 20px;"
                                    type="text" name="homeaddress" id="homeaddress" placeholder="House Name" required>
                                <input class="mt-3 text-center border" style="height: 40px;border-radius: 20px;"
                                    type="text" name="fullAddress" id="fullAddress" placeholder="Street Adress "
                                    required>
                                <input class="mt-3 mb-3 text-center border" style="height: 40px;border-radius: 20px;"
                                    type="text" name="town" id="town" placeholder=" Town/city" required>
                                <input class=" mb-3 text-center border" style="height: 40px;border-radius: 20px;"
                                    type="text" name="country" id="country" placeholder="Country/state" required>
                                <input class=" mb-3 text-center border" style="height: 40px;border-radius: 20px;"
                                    type="number" name="pincode" id="pincode" placeholder="PIN Code" required>
                                <input class="mt-3 text-center border" style="height: 40px;border-radius: 20px;"
                                    type="number" name="phone" id="phone" placeholder="phone" required><br><br>
                                <input type="submit" class="btn btn-primary w-75">
                            </form><br>
                        </div>
                    </div>
                    <div class="" style="text-align: center; padding-left: 80px;">
                        {{#each add}}
                        <div class=" mt-4 w-75 ms-5 border border-info" style="border-radius: 10px; ">
                            <span href="" onclick="editAddress()" class="text-success me-3"
                                style="margin-left: 200px;"><i class="fa-solid fa-pen-to-square"></i></span>
                            <a href="/deleteAdress/{{this.id}}" class="text-danger"><i class="fa-solid fa-trash"
                                    onclick="return confirm('Are you want to delete this product {{this.Name}} ?')"></i></a>
                            <h6 class="ms-5 pt-2">{{this.homeaddress}}</h6>
                            <h6 class="ms-5">{{this.fullAddress}}</h6>
                            <h6 class="ms-5 pb-2">{{this.town}}</h6>
                            <h6 class="ms-5 pb-2">{{this.country}}</h6>
                            <h6 class="ms-5 pb-2">{{this.pincode}}</h6>
                            <h6 class="ms-5 pb-2">{{this.phone}}</h6>
                            <div class="changeAddress text-center border border-3" style="display: none;">
                                <form action="/edit-user-address/{{this._id}}" method="post">
                                    <input class="mt-3 text-center border" style="height: 40px;border-radius: 20px;"
                                        type="text" name="houseName" value="{{this.houseName}}">
                                    <input class="mt-3 text-center border" style="height: 40px;border-radius: 20px;"
                                        type="text" name="address" value="{{this.address}}">
                                    <input class=" mb-3 text-center border" style="height: 40px;border-radius: 20px;"
                                        type="text" name="town" value="{{this.town}}">
                                    <input class=" mb-3 text-center border" style="height: 40px;border-radius: 20px;"
                                        type="text" name="country" value="{{this.country}}">
                                    <input class=" mb-3 text-center border" style="height: 40px;border-radius: 20px;"
                                        type="number" name="pincode" value="{{this.pincode}}">
                                    <input class=" mb-3 text-center border" style="height: 40px;border-radius: 20px;"
                                        type="number" name="phone" value="{{this.phone}}">
                                    <input type="submit" class="btn btn-primary w-75">
                                </form><br>
                            </div>
                        </div>
                        {{/each}}
                    </div><br>
                </div><br>
            </div>
        </div>
    </div>
</section>

<script>
    let uniqueId = new Date()
    document.getElementById('ID').value = uniqueId
</script>

<script>
    let profile = document.querySelector('.changeProfile')
    isPro = true
    function changeProfile() {
        if (isPro) {
            profile.style.display = "block"
            isPro = false
        } else {
            profile.style.display = "none"
            isPro = true
        }
    }

    let edit = document.querySelector('.changeAddress')
    isEdit = true
    function editAddress() {
        if (isEdit) {
            edit.style.display = "block"
            isEdit = false
        } else {
            edit.style.display = "none"
            isEdit = true
        }
    }

    let usersSection = document.querySelector('.address')
    isShow = true
    function showAddress() {
        if (isShow) {
            usersSection.style.display = "block"
            isShow = false
        } else {
            usersSection.style.display = "none"
            isShow = true
        }
    }

    let changePass = document.querySelector('.password')
    isChange = true
    function showPass() {
        console.log(isChange)
        if (isChange) {
            changePass.style.display = "block"
            isChange = false
        } else {
            changePass.style.display = "none"
            isChange = true
        }
    }
</script>



<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.3/dist/jquery.validate.js"></script>

<script>
    $(document).ready(function () {
        jQuery.validator.addMethod(
            "lettersonly",
            function (value, element) {
                return this.optional(element) || /^[-a-zA-Z-()]+(\s+[-a-zA-Z-()]+)*$/.test(value);
            },
            "Letters only please"
        );
        jQuery.validator.addMethod(
            "lettersonly",
            function (value, element) {
                return this.optional(element) || /^[-a-zA-Z-()]+(\s+[-a-zA-Z-()]+)*$/.test(value);
            },
            "Letters only please"
        );
        jQuery.validator.addMethod(
            "minlength4",
            function (value, element) {
                return this.optional(element) || (value.trim().length >= 4);
            },
            "Minimum 4 characters without space"
        );
        $("#submit-address").validate({
            rules: {
                homeaddress: {
                    minlength4: true,
                    lettersonly: true,
                    required: true,
                    minlength: 4,
                },
                fullAddress: {
                    minlength4: true,
                    lettersonly: true,
                    required: true,
                    minlength: 4,
                },
                town: {
                    minlength4: true,
                    lettersonly: true,
                    required: true,
                    minlength: 4,
                },
                country: {
                    minlength4: true,
                    lettersonly: true,
                    required: true,
                    minlength: 4,
                },

                phone: {
                    required: true,
                    number: true,
                    minlength: 10,
                    maxlength: 10,
                },
                pincode: {
                    required: true,
                    minlength: 6,
                    maxlength: 6,
                }
            },
            messages: {
                homeaddress: {
                    minlength: "Please Enter Your home address",
                },
                fullAddress: {
                    fullAddress: "Please enter a full address",
                },
                phone: {
                    minlength: "Please enter a valid contact number",
                    maxlength: "Please enter a valid contact number",
                },
                pincode: {
                    minlength: "Please enter a minimum 6 character"
                }
            },
            submitHandler: function (form) {
                console.log("True");
                console.log("in function submit");
                submit();
            },
        });
    });

</script>


<script>
    jQuery('#submit-form').validate({
        rules: {
            old: {
                minlength: 3,
            },
            new: {
                minlength: 3,
            },
            confirm: {
                minlength: 3,

            }
        }
    });
</script>
<script>
    $(document).ready(function () {
        jQuery.validator.addMethod(
            "lettersonly",
            function (value, element) {
                return this.optional(element) || /^[-a-zA-Z-()]+(\s+[-a-zA-Z-()]+)*$/.test(value);
            },
            "Letters only please"
        );
        jQuery('#user-form').validate({
            rules: {
                Name: {
                    minlength: 4,

                },
            }
        });
    });

</script>